<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>EasyPay - PTC 4</title>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <style>
    body { margin:0; font-family:'Segoe UI',sans-serif; background:#f0fdf4; color:#111; padding:20px; }
    header { background:#00c851; color:#fff; padding:15px; font-size:22px; text-align:center; border-radius:8px; }
    .notice { background:#fff3cd; color:#856404; border:1px solid #ffeeba; padding:10px 15px; border-radius:8px; margin:15px 0; font-weight:bold; text-align:center; }
    .click-notice { background:#e0f7fa; color:#006064; border:1px solid #4dd0e1; padding:10px; border-radius:8px; margin:15px 0; text-align:center; }
    .timer { display:none; font-size:24px; font-weight:bold; color:#00c851; text-align:center; margin:20px 0; }
    .ad-container { text-align:center; margin:10px 0; background:#fafafa; padding:10px; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.05); cursor:pointer; }
    .blog { background:#fff; padding:20px; border-radius:8px; box-shadow:0 0 8px rgba(0,0,0,0.05); line-height:1.7; margin-top:20px; }
    .blog img { max-width:100%; border-radius:8px; margin:15px 0; }
    .blog h2, .blog h3 { color:#00c851; margin-top:1.5rem; }
    .blog ul { margin-left:1.5rem; margin-bottom:1rem; }
    .toast { position:fixed; top:50%; left:50%; transform:translate(-50%,-50%); background:#00c851; color:#fff; padding:40px; border-radius:15px; font-size:26px; font-weight:bold; text-align:center; display:none; z-index:1000; box-shadow:0 0 25px rgba(0,0,0,0.25); width:80%; max-width:500px; }
    footer { text-align:center; padding:1rem; font-size:0.85rem; color:#888; margin-top:40px; }
  </style>
</head>
<body>

  <header>EasyPay - View &amp; Earn (PTC 4)</header>

  <div class="notice">
    Important! Your browser must have JavaScript enabled, your ad blocker must be disabled, you must stay on the final page for about 20 seconds, you must have cookies enabled, and you must not use VPN.
  </div>

  <div class="click-notice" id="clickNotice">
    Please click on the ads below <strong>4 times</strong> in any combination to unlock the timer.
  </div>

  <div class="timer" id="timer">
    Time Remaining: <span id="countdown">20</span> seconds
  </div>

  <!-- Native Ad -->
  <div class="ad-container ad-slot">
    <script async data-cfasync="false" src="//pl26610991.profitableratecpm.com/2cdeaef942bed83f6211550579f2accb/invoke.js"></script>
    <div id="container-2cdeaef942bed83f6211550579f2accb"></div>
  </div>

  <!-- Direct Link Ad -->
  <div class="ad-container ad-slot">
    <script async src="https://www.profitableratecpm.com/bqbfzf660x?key=657708018dbcaca9694b65759c893f86"></script>
  </div>

  <div class="blog">
    <!-- You can keep or replace this blog section as desired -->
    <h2>The World of Sports: A Journey of Passion, Perseverance, and Triumph üèÜ</h2>
    <p>Sports have been an integral part of human culture for centuries, bringing people together, fostering community, and inspiring greatness. From the thrill of competition to the joy of recreation, sports play a significant role in our lives, shaping our personalities, building our character, and creating lifelong memories. üåü</p>
    <!-- ‚Ä¶ rest unchanged ‚Ä¶ -->
  </div>

  <footer>&copy; 2025 EasyPay. All rights reserved.</footer>
  <div class="toast" id="toastMsg"></div>

  <!-- Firebase SDKs (compat) -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

  <script>
    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyDRkip46Ql5KhNfuatWAcAxQzgP5VtQ8UY",
      authDomain: "easypay-6bce8.firebaseapp.com",
      projectId: "easypay-6bce8",
      storageBucket: "easypay-6bce8.appspot.com",
      messagingSenderId: "862671358267",
      appId: "1:862671358267:web:b243c7b69840ef918c8f1e"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db   = firebase.firestore();

    let clickCount = 0;
    const requiredClicks = 4;
    const clickNotice = document.getElementById("clickNotice");
    const timerEl     = document.getElementById("timer");
    const countdownEl = document.getElementById("countdown");

    document.querySelectorAll('.ad-slot').forEach(slot => {
      slot.addEventListener('click', () => {
        clickCount++;
        if (clickCount >= requiredClicks) {
          clickNotice.style.display = 'none';
          timerEl.style.display   = 'block';
          startAuthenticatedCountdown();
        } else {
          clickNotice.textContent = `Please click on the ads below ${requiredClicks - clickCount} more time(s) to unlock the timer.`;
        }
      });
    });

    function showToast(msg, success = true) {
      const toast = document.getElementById("toastMsg");
      toast.textContent = msg;
      toast.style.background = success ? "#00c851" : "#ff4444";
      toast.style.display = "block";
      setTimeout(() => toast.style.display = "none", 5000);
    }

    function startAuthenticatedCountdown() {
      auth.onAuthStateChanged(user => {
        if (!user) {
          window.location.href = "login.html";
          return;
        }
        startCountdown(user);
      });
    }

    function startCountdown(user) {
      let timeLeft = 20;
      countdownEl.textContent = timeLeft;
      const interval = setInterval(() => {
        timeLeft--;
        countdownEl.textContent = timeLeft;
        if (timeLeft <= 0) {
          clearInterval(interval);
          creditUser(user);
        }
      }, 1000);
    }

    function creditUser(user) {
      const ref = db.collection("users").doc(user.uid);
      const now = Date.now();
      ref.get().then(docSnap => {
        const data = docSnap.data() || {};
        const last = data.lastPTC4 || 0;
        const bal  = data.balance   || 0;
        if (now - last >= 86400000) {
          ref.update({
            balance: bal + 1,
            lastPTC4: now,
            transactions: firebase.firestore.FieldValue.arrayUnion({
              type: "PTC 4 Earnings",
              amount: 1,
              date: new Date().toLocaleString()
            })
          });
          showToast("‚Ç¶1 credited successfully!", true);
        } else {
          showToast("You've already claimed ‚Ç¶1 from this PTC today.", false);
        }
      }).catch(err => {
        console.error(err);
        showToast("Error claiming reward. Please try again later.", false);
      });
    }
  </script>
</body>
</html>
