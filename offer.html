<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin â€“ Create Quiz</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f9fff9;
      padding: 20px;
      color: #003300;
    }
    h1 {
      color: #006400;
    }
    .container {
      max-width: 800px;
      margin: auto;
      padding: 20px;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 0 12px rgba(0, 100, 0, 0.1);
    }
    label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
    }
    input[type="text"], select {
      width: 100%;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 6px;
      margin-top: 4px;
    }
    .question-block {
      margin-top: 20px;
      padding: 12px;
      border: 1px solid #ccc;
      border-radius: 8px;
      background: #f4fff4;
    }
    button {
      margin-top: 20px;
      padding: 10px 16px;
      background-color: #006400;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
    }
    table {
      width: 100%;
      margin-top: 30px;
      border-collapse: collapse;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 10px;
      text-align: center;
    }
    th {
      background-color: #e6ffe6;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Create Daily Quiz</h1>
    <label>Select Category</label>
    <select id="category">
      <option value="">-- Choose Category --</option>
      <option value="Science">Science</option>
      <option value="Nature">Nature</option>
      <option value="Food">Food</option>
      <option value="History">History</option>
      <option value="Technology">Technology</option>
      <option value="Health">Health</option>
    </select><div id="questions"></div>

<button onclick="submitQuiz()">Submit Quiz</button>

<h2>Today's Attempts</h2>
<table>
  <thead>
    <tr><th>Category</th><th>Attempts</th></tr>
  </thead>
  <tbody id="statsBody"></tbody>
</table>

  </div>  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDRkip46Ql5KhNfuatWAcAxQzgP5VtQ8UY",
      authDomain: "easypay-6bce8.firebaseapp.com",
      projectId: "easypay-6bce8",
      storageBucket: "easypay-6bce8.appspot.com",
      messagingSenderId: "862671358267",
      appId: "1:862671358267:web:b243c7b69840ef918c8f1e"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const qDiv = document.getElementById('questions');
    for (let i = 1; i <= 10; i++) {
      const block = document.createElement('div');
      block.className = 'question-block';
      block.innerHTML = `
        <label>Question ${i}</label>
        <input type="text" id="q${i}" placeholder="Enter question" />
        <label>Option A</label><input type="text" id="q${i}a" />
        <label>Option B</label><input type="text" id="q${i}b" />
        <label>Option C</label><input type="text" id="q${i}c" />
        <label>Option D</label><input type="text" id="q${i}d" />
        <label>Correct Answer</label>
        <select id="q${i}correct">
          <option value="">Select</option>
          <option value="A">A</option>
          <option value="B">B</option>
          <option value="C">C</option>
          <option value="D">D</option>
        </select>
      `;
      qDiv.appendChild(block);
    }

    async function submitQuiz() {
      const category = document.getElementById('category').value;
      if (!category) return alert("Select a category");

      const today = new Date().toISOString().split('T')[0];
      const quizRef = db.collection("quizzes").doc(category).collection("dates").doc(today);
      const doc = await quizRef.get();
      if (doc.exists) return alert("Quiz already exists for this category today!");

      const questions = [];
      for (let i = 1; i <= 10; i++) {
        const q = document.getElementById(`q${i}`).value.trim();
        const a = document.getElementById(`q${i}a`).value.trim();
        const b = document.getElementById(`q${i}b`).value.trim();
        const c = document.getElementById(`q${i}c`).value.trim();
        const d = document.getElementById(`q${i}d`).value.trim();
        const correct = document.getElementById(`q${i}correct`).value;
        if (!q || !a || !b || !c || !d || !correct) return alert(`Fill all fields for question ${i}`);
        questions.push({ question: q, options: { A: a, B: b, C: c, D: d }, correct });
      }

      await quizRef.set({ questions, createdAt: firebase.firestore.FieldValue.serverTimestamp() });
      alert("Quiz created successfully!");
    }

    async function loadStats() {
      const today = new Date().toISOString().split('T')[0];
      const statsBody = document.getElementById("statsBody");
      const cats = ["Science", "Nature", "Food", "History", "Technology", "Health"];
      for (let cat of cats) {
        const snapshot = await db.collection("quiz_attempts")
          .where("category", "==", cat)
          .where("date", "==", today).get();
        const row = document.createElement("tr");
        row.innerHTML = `<td>${cat}</td><td>${snapshot.size}</td>`;
        statsBody.appendChild(row);
      }
    }

    loadStats();
  </script></body>
</html>
