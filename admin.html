<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Admin Panel - Withdrawals</title>
  <style>
    :root {
      --green: #2e7d32;
      --light-green: #e8f5e9;
      --white: #ffffff;
      --gray: #f9f9f9;
      --shadow: 0 2px 8px rgba(0,0,0,0.1);
    }body {
  font-family: 'Segoe UI', sans-serif;
  background-color: var(--gray);
  margin: 0;
  padding: 0;
}

header {
  background-color: var(--green);
  color: var(--white);
  padding: 1rem 2rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  box-shadow: var(--shadow);
}

h1 {
  font-size: 1.5rem;
  margin: 0;
}

.top-button {
  background-color: var(--white);
  color: var(--green);
  border: none;
  padding: 0.5rem 1rem;
  border-radius: 8px;
  font-weight: bold;
  cursor: pointer;
  box-shadow: var(--shadow);
}

.dropdown {
  position: relative;
  display: inline-block;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: var(--white);
  min-width: 180px;
  box-shadow: var(--shadow);
  z-index: 1000;
  border-radius: 8px;
  margin-top: 8px;
}

.dropdown-content a {
  padding: 12px 16px;
  display: block;
  text-decoration: none;
  color: #333;
  font-weight: 500;
}

.dropdown-content a:hover {
  background-color: var(--light-green);
}

.container {
  padding: 2rem;
}

#withdrawCount {
  font-size: 1.1rem;
  margin-bottom: 10px;
  font-weight: 500;
  color: #004400;
}

input[type="text"] {
  padding: 0.5rem;
  width: 100%;
  max-width: 300px;
  border: 1px solid #ccc;
  border-radius: 5px;
  box-shadow: var(--shadow);
  margin-bottom: 1rem;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 1rem;
  background-color: var(--white);
  border-radius: 8px;
  overflow: hidden;
  box-shadow: var(--shadow);
}

th, td {
  padding: 1rem;
  text-align: left;
  border-bottom: 1px solid #eee;
}

th {
  background-color: var(--light-green);
  font-weight: 600;
}

.btn {
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 5px;
  font-weight: bold;
  cursor: pointer;
  margin-right: 0.5rem;
}

.approve-btn {
  background-color: #4caf50;
  color: white;
}

.decline-btn {
  background-color: #f44336;
  color: white;
}

.modal {
  display: none;
  position: fixed;
  top: 0; left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.4);
  justify-content: center;
  align-items: center;
  z-index: 2000;
}

.modal-content {
  background-color: var(--white);
  padding: 2rem;
  border-radius: 12px;
  width: 90%;
  max-width: 400px;
  box-shadow: var(--shadow);
}

.modal input, .modal select {
  width: 100%;
  padding: 0.75rem;
  margin-bottom: 1rem;
  border: 1px solid #ccc;
  border-radius: 6px;
}

  </style>
</head>
<body>  <header>
    <h1>Admin Panel</h1>
    <div class="dropdown">
      <button class="top-button" onclick="toggleDropdown()">Menu</button>
      <div class="dropdown-content" id="dropdownMenu">
        <a href="admin-withdraw.html">Withdrawals</a>
        <a href="admin-deposit.html">Deposits</a>
        <a href="admin-advertise.html">Adverts</a>
        <a href="admin-task.html">Submissions</a>
        <a href="admin-activate.html">User Records</a>
        <a href="admin-verify.html">User Activations</a>
        <a href="admin-plans.html">User Plans</a>
        <a href="admin-upgrade.html">Upgrades</a>
        <a href="admin-vtu.html">VTU Request</a>
      </div>
    </div>
  </header>  <div class="container">
    <div id="withdrawCount">Total Requests: 0</div>
    <input type="text" id="searchInput" placeholder="Search by Username or UID..." oninput="searchRequests()" />
    <table>
      <thead>
        <tr>
          <th>Username</th>
          <th>UID</th>
          <th>Amount</th>
          <th>Bank</th>
          <th>Account Number</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="requestTableBody"></tbody>
    </table>
  </div>  <div class="modal" id="actionModal">
    <div class="modal-content">
      <h3>Update Withdrawal</h3>
      <select id="actionSelect">
        <option value="approved">Approve</option>
        <option value="declined">Decline</option>
      </select>
      <textarea id="actionNote" placeholder="Optional note..." style="width:100%;height:80px;padding:0.75rem;border:1px solid #ccc;border-radius:6px;margin-bottom:1rem;"></textarea>
      <button class="btn approve-btn" onclick="saveAction()">Save</button>
    </div>
  </div>  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
    import {
      getFirestore,
      collection,
      getDocs,
      doc,
      updateDoc
    } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDRkip46Ql5KhNfuatWAcAxQzgP5VtQ8UY",
      authDomain: "easypay-6bce8.firebaseapp.com",
      projectId: "easypay-6bce8",
      storageBucket: "easypay-6bce8.appspot.com",
      messagingSenderId: "862671358267",
      appId: "1:862671358267:web:b243c7b69840ef918c8f1e",
      measurementId: "G-2FZKDQ47FZ"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    let selectedId = null;

    async function loadRequests() {
      const tbody = document.getElementById("requestTableBody");
      const countEl = document.getElementById("withdrawCount");
      tbody.innerHTML = "";

      const snapshot = await getDocs(collection(db, "withdrawals"));
      countEl.textContent = `Total Requests: ${snapshot.size}`;

      snapshot.forEach(docSnap => {
        const data = docSnap.data();
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${data.username}</td>
          <td>${docSnap.id}</td>
          <td>â‚¦${data.amount}</td>
          <td>${data.bank}</td>
          <td>${data.accountNumber}</td>
          <td>${data.status || 'pending'}</td>
          <td>
            <button class="btn approve-btn" onclick="openModal('${docSnap.id}')">Action</button>
          </td>
        `;
        tbody.appendChild(row);
      });
    }

    window.openModal = (id) => {
      selectedId = id;
      document.getElementById("actionSelect").value = 'approved';
      document.getElementById("actionNote").value = '';
      document.getElementById("actionModal").style.display = "flex";
    };

    window.saveAction = async () => {
      const status = document.getElementById("actionSelect").value;
      const note = document.getElementById("actionNote").value;
      if (selectedId) {
        await updateDoc(doc(db, "withdrawals", selectedId), { status, note });
        document.getElementById("actionModal").style.display = "none";
        await loadRequests();
      }
    };

    window.searchRequests = () => {
      const q = document.getElementById("searchInput").value.toLowerCase();
      document.querySelectorAll("#requestTableBody tr").forEach(row => {
        const username = row.children[0].innerText.toLowerCase();
        const uid = row.children[1].innerText.toLowerCase();
        row.style.display = username.includes(q) || uid.includes(q) ? "" : "none";
      });
    };

    window.addEventListener("click", e => {
      if (e.target === document.getElementById("actionModal")) {
        document.getElementById("actionModal").style.display = "none";
      }
    });

    window.addEventListener("DOMContentLoaded", loadRequests);
  </script>  <script>
    function toggleDropdown() {
      const menu = document.getElementById("dropdownMenu");
      menu.style.display = menu.style.display === "block" ? "none" : "block";
    }
    window.addEventListener("click", e => {
      if (!e.target.closest(".dropdown")) {
        document.getElementById("dropdownMenu").style.display = "none";
      }
    });
  </script></body>
</html>
